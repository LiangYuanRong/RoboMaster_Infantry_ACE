# 步兵机器人代码版本迭代说明

## #1.0

基本运动实现，加速和跟随做了适当的优化（还需继续优化），遥控键盘模式切换基本完成，PID参数调节以及速度参数调节和综合模式选取都集成在了相应的单独文件，调车变得方便了很多，整套文件结构做了较大的改善。控制的代码框架做了改进。 
当前存在bug是云台和底盘通信还有看门狗那边，就是关机到开机中间的切换有时会暴走，需要查出问题

## #1.1

在1.0架构上添加了对多圈编码器的使用，新步兵Y轴编码器控制部分已经完成

## #1.2

can1全路通信有问题，这版代码换回can2板间通信和can1控制电机。云台板can1与底盘Y轴电机，Y轴码盘通信。底盘板控制底盘四个电机以及拨弹电机

## #1.3

这版代码加上了获取P轴蜗轮蜗杆电机获取转速，做P轴速度闭环，还未加位置环。发射部分代码基本功能实现，底盘通过拨轮控制拨弹发射，云台驱动两个摩擦轮

## #1.4

做好了与视觉小电脑部分的对接，把基本的自瞄做了，还没上卡尔曼预测，参数还能继续调

## #1.5

解决了之前can1通信的那个bug，是由于can的半双工导致同时收发频率不能过快，所以基本主控板纯接收，模块纯发送，换了一下can1的整条线路

## #1.6

P轴那里换了新的can编码器

## #1.7

P轴电机换成了3508（暂时是3510），没虚位会好控很多

## #1.8.1beta

Y轴归中方式换成了光电归中，暂时稳定

## #1.8.2beta

can通信方式换成了can2板间，can1电机

## #1.9

大风车对接视觉调了，传回来的数据有点不稳，勉强能打。状态更新稍作改动，控制那边优化了算法

## #2.0

寒假留校稳定版本，can通信基本优化稳定，y轴电机用电机码盘值配合光电进行校正，多次小陀螺测试稳定。添加了外置陀螺仪，暂时稳定

## #2.1

年后第一版，在状态控制逻辑不做大改的情况下，把can2板间通信收发的数据进行了优化，可以两组数据把所有需要的遥控信息发给云台板，待上机测试。

## #2.2

添加遥控断连看门狗，对部分代码优化

## #2.3

完善了多摄像头状态，（模式选择测试是短焦，长焦或工业的普通自瞄）（不同摄像头不同pid），左上右中为打符模式，左下右中是普通自瞄模式。
云台基本运动和底盘分离模式换成用外置陀螺仪的角度。
补给模式添加，按G进入（直到到达目标位置才可继续按G），再次按G可归中（也是只能归中后才能继续按G）

## #2.3.1beta

该版本为双云台测试

## #2.4.2beta

版本为修改f407芯片，对部分代码进行了规范化，功率限制，电容部分进行测试

## #2.5

此版本为疫情第一批返校前完善版本，对代码进行全部规范，对模式重新整理，底盘运动（跟随，陀螺等）参数优化，云台控制参数优化，发射系统完善好，视觉对接串口发送接收函数完善，卡尔曼完善

## #3.0

版本为疫情期间返校后调试代码，更新了副云台的控制算法，云台角度处理算法，大风车调试，视觉相机切换等（现在调试过程代码改得确实有点乱）

